name: Wersje tekstowe do PDF
on: [push, pull_request]
#  push:
#    branches:
#      - main
#    paths:
#      - 'wersje tekstowe/**.md'

jobs:
  generate_pdfs:
    name: Tworzenie PDFow z wersji tekstowych
    runs-on: ubuntu-latest
    if: startsWith(github.ref, 'refs/tags/')
    env: 
#       CI_COMMIT_MESSAGE: Pliki PDF utworzone na podstawie wersji tekstowych
#       CI_COMMIT_AUTHOR: Automat
      PDF_DIR_NAME: Ustawy o PIT - PDF
    steps:
      - uses: actions/checkout@v3
#      - name: Aktualizacja dostępnych zależności
#        run: sudo apt-get update
#      - name: Instalacja LaTeX-a
#        run: sudo apt-get install -y texlive-latex-extra
#      - name: Instalacja Pandoc-a
#        run: sudo apt-get install -y pandoc
#      - name: Generowanie PDFów na podstawie plików Markdown
#        run: |
#          # Włącza wyświetlanie wykonywanych poleceń
#          set -x
#
#          mkdir "${{ env.PDF_DIR_NAME }}"
#
#          for md_file in ./*.md; do
#            # https://pandoc.org/MANUAL.html#layout
#            # https://pandoc.org/MANUAL.html#fonts
#            # https://texfaq.org/FAQ-hyphoff
#            # https://stackoverflow.com/a/76329457/666907
#            pandoc \
#              "${md_file}" \
#              --fail-if-warnings \
#              --pdf-engine pdflatex \
#              --variable geometry:a4paper \
#              --variable geometry:margin=2.5cm \
#              --variable fontsize=12pt \
#              --variable header-includes="\hyphenpenalty=10000" \
#              --variable header-includes="\exhyphenpenalty=10000" \
#              --output "${{ env.PDF_DIR_NAME }}/${md_file%.md}.pdf"
#          done
#
#          zip -r ustawy-o-pit-pdf.zip "${{ env.PDF_DIR_NAME }}"
##       - name: GIT commit+push wygenerowane pliki PDF
##         run: |
##           pwd
##           git config --global user.name "${{ env.CI_COMMIT_AUTHOR }}"
##           git config --global user.email "username@users.noreply.github.com"
##           git add "wersje pdf"
##           git commit -a -m "${{ env.CI_COMMIT_MESSAGE }}"
##           git push
##      - uses: actions/upload-artifact@v3.1.2
##        with:
##          name: ${{ env.PDF_DIR_NAME }}
##          path: ${{ env.PDF_DIR_NAME }}
#      - name: Release
#        uses: softprops/action-gh-release@v1
#        with:
#          files: |
#            ${{ env.PDF_DIR_NAME }}/*.pdf
#            ustawy-o-pit-pdf.zip
